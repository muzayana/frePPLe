<?xml version="1.0" encoding="UTF-8" ?>
<plan xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <name>Test model for suppliers</name>
  <description>
  In this test we verify the creation of procurements, triggered by
  supplieritem definitions.
  </description>
  <current>2015-01-01T00:00:00</current>
  <suppliers>
    <!--
    Item A has 2 suppliers: one defined at the supplier level, and one
    at the group level below.
    -->
    <supplier name="Supplier of component A">
	    <supplieritems>
	      <supplieritem>
          <item name="Component A"/>
          <leadtime>P7D</leadtime>
          <priority>2</priority>
        </supplieritem>
	    </supplieritems>
	  </supplier>
  </suppliers>
  <items>
    <item name="Component group A and B" price="1">
	    <supplieritems>
	      <supplieritem>
          <supplier name="Supplier of components A and B" />
          <leadtime>P14D</leadtime>
          <priority>1</priority>
        </supplieritem>
	    </supplieritems>
    </item>
    <!--
    Item B has 2 suppliers: one defined at the item level, and one
    at the group level.
    -->
    <item name="Component B" price="1">
	    <supplieritems>
	      <supplieritem>
          <supplier name="Supplier of component B" />
          <leadtime>P14D</leadtime>
          <priority>1</priority>
        </supplieritem>
	    </supplieritems>
	  </item>
    <!-- Item C has a single supplier. -->
    <item name="Component C" price="1">
	    <supplieritems>
	      <supplieritem>
          <supplier name="Supplier of component C" />
          <leadtime>P21D</leadtime>
          <priority>1</priority>
          <size_multiple>100</size_multiple>
          <size_minimum>125</size_minimum>
        </supplieritem>
	    </supplieritems>
    </item>
    <!-- Item D has no supplier. -->
    <item name="Component D" price="1"/>
  </items>

  <buffers>
    <buffer name="A @ warehouse" onhand="100"><item name="Component A"/></buffer>
    <buffer name="B @ warehouse" onhand="100"><item name="Component B"/></buffer>
    <buffer name="C @ warehouse" onhand="100"><item name="Component C"/></buffer>
    <buffer name="D @ warehouse" onhand="100"><item name="Component D"/></buffer>
  </buffers>

  <demands>
  </demands>

<?python
print("SAVING MODEL IN XML FORMAT")
frepple.saveXMLfile("output.1.xml")

print("CREATING CONSTRAINED PLAN")
frepple.solver_mrp(plantype=1, constraints=15, loglevel=2).solve()
frepple.saveplan("output.2.xml")

print("CREATING UNCONSTRAINED PLAN")
frepple.solver_mrp(plantype=2, constraints=15, loglevel=2).solve()
frepple.saveplan("output.3.xml")

print("TESTING PYTHON API")
s = frepple.supplier(name="X")
r = frepple.item(name='Y')
frepple.supplieritem(supplier=s, item=r)
with open("output.4.xml","wt") as output:
  for i in frepple.suppliers():
    print("Supplier", i.name, ":", file=output)
    for j in i.supplieritems:
      print("     ", j.item.name, file=output)
  for i in frepple.items():
    print("Item", i.name, ":", file=output)
    for j in i.supplieritems:
      print("     ", j.supplier.name, file=output)

print("ERASE PLAN DATA")
frepple.erase(False)

print("ERASE ALL DATA")
frepple.erase(True)
?>

</plan>
